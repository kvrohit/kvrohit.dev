---
import Layout from "../../layouts/Layout.astro";

let posts = await Astro.glob("../../posts/*.md");
posts = posts.sort(
  (a, b) =>
    new Date(b.frontmatter.date).valueOf() -
    new Date(a.frontmatter.date).valueOf()
);
---

<Layout title="Blog - kvrohit.dev">
  <nav>
    <h1 class="text-3xl my-4">
      <span
        class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 to-red-500 font-bold"
        >Blog
      </span>
    </h1>
    <ul>
      <li>
        <a class="text-gray-500 hover:text-gray-800" href="/">&larr; home</a>
      </li>
    </ul>
  </nav>
  <main>
    {
      posts.map((post, index) => {
        const href = `/blog/${post.file.split("/").pop().split(".").shift()}`;
        return (
          <div class="my-8 flex sm:flex-row flex-col gap-2 sm:gap-4 sm:divide-x-2 border-b pb-8 sm:border-none sm:pb-0">
            <div class="sm:flex sm:flex-col items-center justify-center sm:min-w-max">
              <span class="sm:text-2xl sm:block text-gray-500 sm:text-gray-600">
                {new Date(post.frontmatter.date).toLocaleString("en-US", {
                  day: "2-digit",
                })}
              </span>
              <span class="sm:font-sm sm:block text-gray-500">
                {new Date(post.frontmatter.date).toLocaleString("en-US", {
                  year: "numeric",
                  month: "short",
                })}
              </span>
            </div>
            <div class="sm:px-4">
              <h2 class="text-xl md:text-2xl mb-2 text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 to-red-500">
                <a class="hover:text-indigo-800" href={href}>
                  {post.frontmatter.title} &rarr;
                </a>
              </h2>
              <p class="text-gray-500">{post.frontmatter.description}</p>
            </div>
          </div>
        );
      })
    }
  </main>
</Layout>
